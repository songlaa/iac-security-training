<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Various | iac security Training</title>
<meta name=description content="Preparation Create a new directory for this exercise:
mkdir $LAB_ROOT/advanced/various cd $LAB_ROOT/advanced/various Step 5.3.1: Variable structure Terraform variables support nested complex types like nested maps and sets. The type keyword of the variable block allows the definition of type constraints to enforce the correctness of the input (or default) value. See https://developer.hashicorp.com/terraform/language/expressions/type-constraints for the specification.
Create a new file named variables.tf and add the following content:
variable &amp;#34;clouds&amp;#34; { default = { aws = { company = &amp;#34;Amazon&amp;#34; founder = &amp;#34;Jeff Bezos&amp;#34; cloud_rank = 1 } azure = { company = &amp;#34;Microsoft&amp;#34; founder = &amp;#34;Bill Gates&amp;#34; cloud_rank = 2 } gcp = { company = &amp;#34;Google&amp;#34; founder = &amp;#34;Larry Page and Sergey Brin&amp;#34; cloud_rank = 3 } } type = map(object({ company = string founder = string cloud_rank = number })) } The code snippet above defines a map for the top three cloud platforms with three attributes:"><meta property="og:title" content="Various"><meta property="og:description" content='Preparation Create a new directory for this exercise:
mkdir $LAB_ROOT/advanced/various cd $LAB_ROOT/advanced/various Step 5.3.1: Variable structure Terraform variables support nested complex types like nested maps and sets. The type keyword of the variable block allows the definition of type constraints to enforce the correctness of the input (or default) value. See https://developer.hashicorp.com/terraform/language/expressions/type-constraints for the specification.
Create a new file named variables.tf and add the following content:
variable "clouds" { default = { aws = { company = "Amazon" founder = "Jeff Bezos" cloud_rank = 1 } azure = { company = "Microsoft" founder = "Bill Gates" cloud_rank = 2 } gcp = { company = "Google" founder = "Larry Page and Sergey Brin" cloud_rank = 3 } } type = map(object({ company = string founder = string cloud_rank = number })) } The code snippet above defines a map for the top three cloud platforms with three attributes:'><meta property="og:type" content="article"><meta property="og:url" content="/docs/05/3-various/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2024-10-21T16:14:33+02:00"><meta itemprop=name content="Various"><meta itemprop=description content='Preparation Create a new directory for this exercise:
mkdir $LAB_ROOT/advanced/various cd $LAB_ROOT/advanced/various Step 5.3.1: Variable structure Terraform variables support nested complex types like nested maps and sets. The type keyword of the variable block allows the definition of type constraints to enforce the correctness of the input (or default) value. See https://developer.hashicorp.com/terraform/language/expressions/type-constraints for the specification.
Create a new file named variables.tf and add the following content:
variable "clouds" { default = { aws = { company = "Amazon" founder = "Jeff Bezos" cloud_rank = 1 } azure = { company = "Microsoft" founder = "Bill Gates" cloud_rank = 2 } gcp = { company = "Google" founder = "Larry Page and Sergey Brin" cloud_rank = 3 } } type = map(object({ company = string founder = string cloud_rank = number })) } The code snippet above defines a map for the top three cloud platforms with three attributes:'><meta itemprop=dateModified content="2024-10-21T16:14:33+02:00"><meta itemprop=wordCount content="286"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Various"><meta name=twitter:description content='Preparation Create a new directory for this exercise:
mkdir $LAB_ROOT/advanced/various cd $LAB_ROOT/advanced/various Step 5.3.1: Variable structure Terraform variables support nested complex types like nested maps and sets. The type keyword of the variable block allows the definition of type constraints to enforce the correctness of the input (or default) value. See https://developer.hashicorp.com/terraform/language/expressions/type-constraints for the specification.
Create a new file named variables.tf and add the following content:
variable "clouds" { default = { aws = { company = "Amazon" founder = "Jeff Bezos" cloud_rank = 1 } azure = { company = "Microsoft" founder = "Bill Gates" cloud_rank = 2 } gcp = { company = "Google" founder = "Larry Page and Sergey Brin" cloud_rank = 3 } } type = map(object({ company = string founder = string cloud_rank = number })) } The code snippet above defines a map for the top three cloud platforms with three attributes:'><link rel=preload href=/scss/main.min.489e156ad05e59efb10d446a42479e2d14bcbdc7388c5c52fb2c6dcbe204b264.css as=style><link href=/scss/main.min.489e156ad05e59efb10d446a42479e2d14bcbdc7388c5c52fb2c6dcbe204b264.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script></head><body class=td-page><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"></span><span class=navbar-brand__name>iac security Training</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/setup/><span>Setup</span></a></li><li class=nav-item><a class=nav-link href=/slides/><span>Slides</span></a></li><li class=nav-item><a class=nav-link href=https://songlaa.com target=_blank rel=noopener><span>songlaa gmbh</span></a></li></ul></div><div class="d-none d-lg-block"></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="td-sidebar-nav collapse" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docs-li><a href=/docs/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-docs><span>Labs</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docs01-li><a href=/docs/01/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docs01><span>1. Introduction</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docs02-li><a href=/docs/02/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docs02><span>2. First steps</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docs03-li><a href=/docs/03/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docs03><span>3. Basics</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docs031-resources-li><a href=/docs/03/1-resources/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docs031-resources><span>3.1. Resources</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docs032-variables-li><a href=/docs/03/2-variables/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docs032-variables><span>3.2. Variables</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docs033-outputs-li><a href=/docs/03/3-outputs/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docs033-outputs><span>3.3. Outputs</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docs034-data-sources-li><a href=/docs/03/4-data-sources/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docs034-data-sources><span>3.4. Data Sources</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docs035-types-and-functions-li><a href=/docs/03/5-types-and-functions/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docs035-types-and-functions><span>3.5. Types / Functions</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docs04-li><a href=/docs/04/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docs04><span>4. Intermediate</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docs041-versions-li><a href=/docs/04/1-versions/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docs041-versions><span>4.1. Versions</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docs042-count-loops-li><a href=/docs/04/2-count-loops/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docs042-count-loops><span>4.2. Count / Loops</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docs043-backend-state-li><a href=/docs/04/3-backend-state/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docs043-backend-state><span>4.3. Backend State</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docs044-config-files-li><a href=/docs/04/4-config-files/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docs044-config-files><span>4.4. Config Files</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docs05-li><a href=/docs/05/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docs05><span>5. Advanced</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docs051-modules-li><a href=/docs/05/1-modules/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docs051-modules><span>5.1. Modules</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docs052-meta-arguments-li><a href=/docs/05/2-meta-arguments/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docs052-meta-arguments><span>5.2. Meta-Arguments</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-docs053-various-li><a href=/docs/05/3-various/ class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-docs053-various><span class=td-sidebar-nav-active-item>5.3. Various</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docs054-templates-li><a href=/docs/05/4-templates/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docs054-templates><span>5.4. Templates</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docs055-terraform-operations-li><a href=/docs/05/5-terraform-operations/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docs055-terraform-operations><span>5.5. Terraform CLI</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docs056-tfsec-li><a href=/docs/05/6-tfsec/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docs056-tfsec><span>5.6. tfsec</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docs057-keyvault-li><a href=/docs/05/7-keyvault/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docs057-keyvault><span>5.7. Azure Keyvault</span></a></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"><a href=https://github.com/songlaa/iac-security-training/tree/main/content/en/docs/05/3-various.md class="td-page-meta--view td-page-meta__view" target=_blank rel=noopener><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a href=https://github.com/songlaa/iac-security-training/edit/main/content/en/docs/05/3-various.md class="td-page-meta--edit td-page-meta__edit" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a href="https://github.com/songlaa/iac-security-training/new/main/content/en/docs/05?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class="td-page-meta--child td-page-meta__child" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a href="https://github.com/songlaa/iac-security-training/issues/new?title=Various" class="td-page-meta--issue td-page-meta__issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#preparation>Preparation</a></li><li><a href=#step-531-variable-structure>Step 5.3.1: Variable structure</a></li><li><a href=#step-532-dynamic-blocks>Step 5.3.2: Dynamic blocks</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/docs/>Labs</a></li><li class=breadcrumb-item><a href=/docs/05/>Advanced</a></li><li class="breadcrumb-item active" aria-current=page>Various</li></ol></nav><div class=td-content><h1>5.3. Various</h1><header class=article-meta></header><h2 id=preparation>Preparation</h2><p>Create a new directory for this exercise:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir <span style=color:#000>$LAB_ROOT</span>/advanced/various
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> <span style=color:#000>$LAB_ROOT</span>/advanced/various
</span></span></code></pre></div><h2 id=step-531-variable-structure>Step 5.3.1: Variable structure</h2><p>Terraform variables support nested complex types like nested maps and sets. The <code>type</code> keyword of the <code>variable</code>
block allows the definition of type constraints to enforce the correctness of the input (or default) value.
See <a href=https://developer.hashicorp.com/terraform/language/expressions/type-constraints target=_blank rel=noopener>https://developer.hashicorp.com/terraform/language/expressions/type-constraints</a>
for the specification.</p><p>Create a new file named <code>variables.tf</code> and add the following content:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-terraform data-lang=terraform><span style=display:flex><span><span style=color:#204a87;font-weight:700>variable</span> <span style=color:#4e9a06>&#34;clouds&#34;</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#c4a000>default</span> = <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#c4a000>aws</span> = <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#c4a000>company</span> = <span style=color:#4e9a06>&#34;Amazon&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#c4a000>founder</span> = <span style=color:#4e9a06>&#34;Jeff Bezos&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#c4a000>cloud_rank</span> = <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#c4a000>azure</span> = <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#c4a000>company</span> = <span style=color:#4e9a06>&#34;Microsoft&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#c4a000>founder</span> = <span style=color:#4e9a06>&#34;Bill Gates&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#c4a000>cloud_rank</span> = <span style=color:#0000cf;font-weight:700>2</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#c4a000>gcp</span> = <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#c4a000>company</span> = <span style=color:#4e9a06>&#34;Google&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#c4a000>founder</span> = <span style=color:#4e9a06>&#34;Larry Page and Sergey Brin&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#c4a000>cloud_rank</span> = <span style=color:#0000cf;font-weight:700>3</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#c4a000>type</span> =<span style=color:#204a87> map</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>object</span><span style=color:#000;font-weight:700>({</span>
</span></span><span style=display:flex><span>    <span style=color:#c4a000>company</span> = <span style=color:#000>string</span>
</span></span><span style=display:flex><span>    <span style=color:#c4a000>founder</span> = <span style=color:#000>string</span>
</span></span><span style=display:flex><span>    <span style=color:#c4a000>cloud_rank</span> = <span style=color:#000>number</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>}))</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>The code snippet above defines a map for the top three cloud platforms with three attributes:</p><ul><li>company</li><li>founder</li><li>cloud_rank</li></ul><h2 id=step-532-dynamic-blocks>Step 5.3.2: Dynamic blocks</h2><p>Some Terraform resources (and data sources) have repetitive blocks, for example <code>archive_file</code>. See documentation
at <a href=https://registry.terraform.io/providers/hashicorp/archive/latest/docs/data-sources/file target=_blank rel=noopener>https://registry.terraform.io/providers/hashicorp/archive/latest/docs/data-sources/file</a></p><p>Example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-terraform data-lang=terraform><span style=display:flex><span><span style=color:#204a87;font-weight:700>data</span> <span style=color:#4e9a06>&#34;archive_file&#34;</span> <span style=color:#4e9a06>&#34;dotfiles&#34;</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#c4a000>type</span>        = <span style=color:#4e9a06>&#34;zip&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#c4a000>output_path</span> = <span style=color:#4e9a06>&#34;dotfiles.zip&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex;background-color:#dfdfdf><span>  <span style=color:#000>source</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex;background-color:#dfdfdf><span>    <span style=color:#c4a000>content</span>  = <span style=color:#4e9a06>&#34;# nothing&#34;</span>
</span></span><span style=display:flex;background-color:#dfdfdf><span>    <span style=color:#c4a000>filename</span> = <span style=color:#4e9a06>&#34;.vimrc&#34;</span>
</span></span><span style=display:flex;background-color:#dfdfdf><span>  <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex;background-color:#dfdfdf><span>
</span></span><span style=display:flex;background-color:#dfdfdf><span>  <span style=color:#000>source</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex;background-color:#dfdfdf><span>    <span style=color:#c4a000>content</span>  = <span style=color:#4e9a06>&#34;# comment&#34;</span>
</span></span><span style=display:flex;background-color:#dfdfdf><span>    <span style=color:#c4a000>filename</span> = <span style=color:#4e9a06>&#34;.ssh/config&#34;</span>
</span></span><span style=display:flex;background-color:#dfdfdf><span>  <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span></span></span></code></pre></div><p>To add such blocks repetitively, we can use the <code>dynamic</code> keyword as documented here:
<a href=https://www.terraform.io/docs/language/expressions/dynamic-blocks.html target=_blank rel=noopener>https://www.terraform.io/docs/language/expressions/dynamic-blocks.html</a></p><p>Create a new file named <code>main.tf</code> and add the following content:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-terraform data-lang=terraform><span style=display:flex><span><span style=color:#204a87;font-weight:700>data</span> <span style=color:#4e9a06>&#34;archive_file&#34;</span> <span style=color:#4e9a06>&#34;clouds&#34;</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#c4a000>type</span>        = <span style=color:#4e9a06>&#34;zip&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#c4a000>output_path</span> = <span style=color:#4e9a06>&#34;clouds.zip&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#000>dynamic</span> <span style=color:#4e9a06>&#34;source&#34;</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#c4a000>for_each</span> = <span style=color:#204a87>var</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>clouds</span>
</span></span><span style=display:flex><span>    <span style=color:#000>content</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#c4a000>filename</span> = <span style=color:#4e9a06>&#34;</span><span style=color:#4e9a06>${</span><span style=color:#000>source</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>key</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>.txt&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#c4a000>content</span> =<span style=color:#204a87> jsonencode</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>source</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>value</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>This will create a zip file containing a text file for each entry in the <code>clouds</code> map variable defined previously.</p><p>Now run:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>terraform init
</span></span><span style=display:flex><span>terraform apply
</span></span><span style=display:flex><span>unzip clouds.zip
</span></span><span style=display:flex><span>cat *txt
</span></span></code></pre></div><div class="text-muted mt-5 pt-3"><div class=row><div class=col-sm><a href=/docs/05/2-meta-arguments/ data-toggle=tooltip title=Meta-Arguments><i class="fa fa-arrow-circle-left"></i> Previous</a></div><div class="col-sm text-right"><a href=/docs/05/4-templates/ data-toggle=tooltip title=Templates>Next <i class="fa fa-arrow-circle-right"></i></a></div></div></div><div class=td-page-meta__lastmod>Last modified October 21, 2024: <a href=https://github.com/songlaa/iac-security-training/commit/26b228d094eb39a65a7cd69808ef2ee3ae741b09>first version (26b228d)</a></div></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=LinkedIn aria-label=LinkedIn><a target=_blank rel=noopener href=https://www.linkedin.com/in/gabriel-graf-6b6446319 aria-label=LinkedIn><i class="fab fa-"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/songlaa/iac-security-training aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2024
<span class=td-footer__authors>songlaa gmbh</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span></div></div></div></footer></div><script src=/js/main.min.d05ad35ff2c6dc165933414181dc1f183f98fc42e97d00f21d8d3d73d13ab4e1.js integrity="sha256-0FrTX/LG3BZZM0FBgdwfGD+Y/ELpfQDyHY09c9E6tOE=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script><script src=/js/site.min.1b86eee028c038e3c091bb0e4a5f11d864071cfddfac37a5b7d7dc4b7af9bd0a.js integrity="sha256-G4bu4CjAOOPAkbsOSl8R2GQHHP3frDelt9fcS3r5vQo=" crossorigin=anonymous></script></body></html>